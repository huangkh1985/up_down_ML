# è‚¡ç¥¨è¿‡æ»¤é…ç½®è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

æœ¬ç³»ç»Ÿå·²æ·»åŠ è‡ªåŠ¨è¿‡æ»¤åŠŸèƒ½ï¼Œå¯ä»¥æ’é™¤ä»¥ä¸‹ç±»å‹çš„è‚¡ç¥¨ï¼š
- **STè‚¡ç¥¨**: åŒ…æ‹¬STã€*STç­‰ç‰¹åˆ«å¤„ç†è‚¡ç¥¨
- **æ¬¡æ–°è‚¡**: ä¸Šå¸‚æ—¶é—´ä¸è¶³æŒ‡å®šå¤©æ•°çš„è‚¡ç¥¨
- **æ•°æ®ä¸è¶³è‚¡ç¥¨**: å†å²æ•°æ®è®°å½•è¿‡å°‘çš„è‚¡ç¥¨

## é…ç½®å‚æ•°

### 1. STè‚¡å’Œæ¬¡æ–°è‚¡è¿‡æ»¤ (åœ¨ `filter_stocks` å‡½æ•°ä¸­)

å¯ä»¥åœ¨ `get_billboard_stocks()` å‡½æ•°çš„è¿”å›å‰è°ƒæ•´ä»¥ä¸‹å‚æ•°ï¼š

```python
filtered_stocks = filter_stocks(
    selected_stocks, 
    exclude_st=True,           # æ˜¯å¦æ’é™¤STè‚¡ (True/False)
    exclude_new_stock=True,    # æ˜¯å¦æ’é™¤æ¬¡æ–°è‚¡ (True/False)
    new_stock_days=365         # æ¬¡æ–°è‚¡å®šä¹‰ï¼šä¸Šå¸‚æ—¶é—´å°‘äºå¤šå°‘å¤©
)
```

**å‚æ•°è¯´æ˜:**
- `exclude_st`: è®¾ä¸º `True` æ’é™¤STè‚¡ï¼Œ`False` ä¿ç•™STè‚¡
- `exclude_new_stock`: è®¾ä¸º `True` æ’é™¤æ¬¡æ–°è‚¡ï¼Œ`False` ä¿ç•™æ¬¡æ–°è‚¡
- `new_stock_days`: æ¬¡æ–°è‚¡åˆ¤æ–­æ ‡å‡†ï¼Œå»ºè®®å€¼ï¼š
  - `180` = 6ä¸ªæœˆï¼ˆä¸¥æ ¼ï¼‰
  - `365` = 1å¹´ï¼ˆæ¨èï¼‰
  - `730` = 2å¹´ï¼ˆå®½æ¾ï¼‰

### 2. æ•°æ®è®°å½•æ•°é‡è¦æ±‚ (åœ¨ `download_china_stock_enhanced_data` å‡½æ•°ä¸­)

å¯ä»¥åœ¨ `main()` å‡½æ•°ä¸­è°ƒæ•´ï¼š

```python
stock_data = download_china_stock_enhanced_data(
    china_stocks, 
    start_date=analysis_start_date, 
    end_date=analysis_end_date,
    save_to_file=True,
    min_data_points=180  # æœ€å°‘æ•°æ®ç‚¹è¦æ±‚
)
```

**å‚æ•°è¯´æ˜:**
- `min_data_points`: è‚¡ç¥¨å¿…é¡»æœ‰çš„æœ€å°‘äº¤æ˜“æ—¥æ•°æ®ï¼Œå»ºè®®å€¼ï¼š
  - `120` = çº¦6ä¸ªæœˆæ•°æ®ï¼ˆå®½æ¾ï¼‰
  - `180` = çº¦9ä¸ªæœˆæ•°æ®ï¼ˆæ¨èï¼‰
  - `250` = çº¦1å¹´æ•°æ®ï¼ˆä¸¥æ ¼ï¼‰

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: ä¸¥æ ¼ç­›é€‰ï¼ˆæ¨èç”¨äºæ¨¡å‹è®­ç»ƒï¼‰

```python
# åœ¨ stock_data_downloader.py çš„ get_billboard_stocks() å‡½æ•°ä¸­
filtered_stocks = filter_stocks(
    selected_stocks, 
    exclude_st=True,           # æ’é™¤STè‚¡
    exclude_new_stock=True,    # æ’é™¤æ¬¡æ–°è‚¡
    new_stock_days=365         # ä¸Šå¸‚ä¸è¶³1å¹´çš„ç®—æ¬¡æ–°è‚¡
)

# åœ¨ main() å‡½æ•°ä¸­
stock_data = download_china_stock_enhanced_data(
    china_stocks,
    min_data_points=250  # è¦æ±‚è‡³å°‘1å¹´æ•°æ®
)
```

### ç¤ºä¾‹2: å®½æ¾ç­›é€‰ï¼ˆè·å–æ›´å¤šè‚¡ç¥¨ï¼‰

```python
# åœ¨ stock_data_downloader.py çš„ get_billboard_stocks() å‡½æ•°ä¸­
filtered_stocks = filter_stocks(
    selected_stocks, 
    exclude_st=True,           # æ’é™¤STè‚¡
    exclude_new_stock=True,    # æ’é™¤æ¬¡æ–°è‚¡
    new_stock_days=180         # ä¸Šå¸‚ä¸è¶³6ä¸ªæœˆçš„ç®—æ¬¡æ–°è‚¡
)

# åœ¨ main() å‡½æ•°ä¸­
stock_data = download_china_stock_enhanced_data(
    china_stocks,
    min_data_points=120  # è¦æ±‚è‡³å°‘6ä¸ªæœˆæ•°æ®
)
```

### ç¤ºä¾‹3: ä¸è¿‡æ»¤æ¬¡æ–°è‚¡ï¼ˆéœ€è¦æ›´å¤šæ ·æœ¬ï¼‰

```python
filtered_stocks = filter_stocks(
    selected_stocks, 
    exclude_st=True,           # åªæ’é™¤STè‚¡
    exclude_new_stock=False,   # ä¸æ’é™¤æ¬¡æ–°è‚¡
    new_stock_days=365
)
```

## è¾“å‡ºä¿¡æ¯

ç¨‹åºè¿è¡Œæ—¶ä¼šæ˜¾ç¤ºè¯¦ç»†çš„è¿‡æ»¤ä¿¡æ¯ï¼š

```
å¼€å§‹è¿‡æ»¤è‚¡ç¥¨...
  åŸå§‹è‚¡ç¥¨æ•°é‡: 30
  æ’é™¤STè‚¡: True
  æ’é™¤æ¬¡æ–°è‚¡: True (ä¸Šå¸‚<365å¤©)

  âœ“ 600519 (è´µå·èŒ…å°): é€šè¿‡è¿‡æ»¤
  âœ— 301357 (STåä¿¡): STè‚¡ï¼Œå·²æ’é™¤
  âœ— 688585 (æ³½ç’Ÿåˆ¶è¯): æ¬¡æ–°è‚¡(ä¸Šå¸‚245å¤©)ï¼Œå·²æ’é™¤

è¿‡æ»¤ç»“æœç»Ÿè®¡:
  é€šè¿‡è¿‡æ»¤: 25 åª
  æ’é™¤STè‚¡: 2 åª
  æ’é™¤æ¬¡æ–°è‚¡: 3 åª
  è·å–ä¿¡æ¯å¤±è´¥: 0 åª
```

## ä¿®æ”¹ä½ç½®

å¦‚éœ€ä¿®æ”¹é…ç½®ï¼Œè¯·ç¼–è¾‘ä»¥ä¸‹æ–‡ä»¶ï¼š

**æ–‡ä»¶:** `stock_data_downloader.py`

**ä½ç½®1 - STè‚¡å’Œæ¬¡æ–°è‚¡è¿‡æ»¤** (çº¦ç¬¬204-209è¡Œ):
```python
filtered_stocks = filter_stocks(
    selected_stocks, 
    exclude_st=True,           # ğŸ‘ˆ åœ¨æ­¤ä¿®æ”¹
    exclude_new_stock=True,    # ğŸ‘ˆ åœ¨æ­¤ä¿®æ”¹
    new_stock_days=365         # ğŸ‘ˆ åœ¨æ­¤ä¿®æ”¹
)
```

**ä½ç½®2 - æ•°æ®è®°å½•è¦æ±‚** (çº¦ç¬¬474è¡Œ):
```python
stock_data = download_china_stock_enhanced_data(
    china_stocks,
    min_data_points=180  # ğŸ‘ˆ åœ¨æ­¤ä¿®æ”¹
)
```

## æ³¨æ„äº‹é¡¹

1. **å¹³è¡¡æ ·æœ¬æ•°é‡**: è¿‡æ»¤å¤ªä¸¥æ ¼å¯èƒ½å¯¼è‡´å¯ç”¨è‚¡ç¥¨æ•°é‡è¿‡å°‘
2. **è®¡ç®—èµ„æº**: æ›´å¤šè‚¡ç¥¨æ„å‘³ç€æ›´é•¿çš„è®¡ç®—æ—¶é—´
3. **æ¨¡å‹è´¨é‡**: STè‚¡å’Œæ¬¡æ–°è‚¡æ•°æ®è´¨é‡è¾ƒå·®ï¼Œå»ºè®®æ’é™¤
4. **æ•°æ®å®Œæ•´æ€§**: ç¡®ä¿è‚¡ç¥¨æœ‰è¶³å¤Ÿçš„å†å²æ•°æ®ç”¨äºç‰¹å¾æå–

## æ¨èé…ç½®

å¯¹äºå¤§å¤šæ•°åˆ†æåœºæ™¯ï¼Œæ¨èä½¿ç”¨å½“å‰é»˜è®¤é…ç½®ï¼š
- âœ… æ’é™¤STè‚¡
- âœ… æ’é™¤ä¸Šå¸‚ä¸è¶³1å¹´çš„æ¬¡æ–°è‚¡
- âœ… è¦æ±‚è‡³å°‘180å¤©ï¼ˆ9ä¸ªæœˆï¼‰çš„äº¤æ˜“æ•°æ®

è¿™æ ·å¯ä»¥åœ¨ä¿è¯æ•°æ®è´¨é‡çš„åŒæ—¶ï¼Œè·å¾—è¶³å¤Ÿæ•°é‡çš„é«˜è´¨é‡è‚¡ç¥¨æ ·æœ¬ã€‚
